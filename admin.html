<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Admin Panel ‚Äî Cari tau yuk</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay">
    <div class="spinner"></div>
</div>

<!-- LOGIN -->
<div id="loginSection" class="login-container">
    <div class="login-card">
        <div class="login-header">
            <div class="login-logo"><i class="fas fa-compass"></i></div>
            <h2 class="login-title">Admin Login</h2>
            <p class="login-subtitle">Masuk ke panel admin Cari tau yuk</p>
        </div>
        <form id="loginForm">
            <div class="form-group" style="margin-bottom:1rem">
                <label class="form-label"><i class="fas fa-envelope"></i> Email</label>
                <input type="email" id="email" class="form-control" placeholder="admin@example.com" required autocomplete="email">
            </div>
            <div class="form-group" style="margin-bottom:1.5rem">
                <label class="form-label"><i class="fas fa-lock"></i> Password</label>
                <input type="password" id="password" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password">
            </div>
            <button type="submit" class="btn btn-primary btn-block">
                <i class="fas fa-sign-in-alt"></i> Masuk
            </button>
        </form>
        <div class="login-back">
            <a href="index.html"><i class="fas fa-arrow-left"></i> Kembali ke Beranda</a>
        </div>
    </div>
</div>

<!-- ADMIN PANEL -->
<div id="adminSection" class="admin-container hidden">

    <!-- Sidebar overlay (mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Sidebar -->
    <aside class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-header">
            <a href="index.html" class="sidebar-logo">
                <i class="fas fa-compass"></i><span>Cari tau yuk</span>
            </a>
            <div class="sidebar-user">
                <div class="user-avatar" id="userAvatar">A</div>
                <div class="user-info">
                    <div class="user-name"  id="userName">Admin</div>
                    <div class="user-email" id="userEmail">admin@example.com</div>
                </div>
            </div>
        </div>

        <ul class="admin-nav">
            <li class="admin-nav-item"><a href="#" class="admin-nav-link active"><i class="fas fa-chart-pie"></i><span>Dashboard</span></a></li>
            <li class="admin-nav-item"><a href="#" class="admin-nav-link"><i class="fas fa-newspaper"></i><span>Kelola Konten</span></a></li>
            <li class="admin-nav-item"><a href="#" class="admin-nav-link"><i class="fas fa-tags"></i><span>Kategori</span></a></li>
            <li class="admin-nav-item"><a href="#" class="admin-nav-link"><i class="fas fa-users"></i><span>Pengguna</span></a></li>
            <li class="admin-nav-item"><a href="#" class="admin-nav-link"><i class="fas fa-chart-bar"></i><span>Statistik</span></a></li>
            <li class="admin-nav-item"><a href="#" class="admin-nav-link"><i class="fas fa-cog"></i><span>Pengaturan</span></a></li>
        </ul>

        <div class="sidebar-footer">
            <a href="#" id="logoutBtn" class="admin-nav-link logout-link">
                <i class="fas fa-sign-out-alt"></i><span>Keluar</span>
            </a>
        </div>
    </aside>

    <!-- Main -->
    <main class="admin-main">

        <!-- Mobile Topbar -->
        <div class="mobile-topbar">
            <button class="hamburger-btn" id="hamburgerBtn" aria-label="Buka menu">
                <span></span><span></span><span></span>
            </button>
            <span class="mobile-title">Dashboard</span>
            <button id="addContentBtnMobile" class="btn btn-primary btn-sm">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <!-- Desktop Header -->
        <div class="admin-header">
            <h1 class="admin-title"><i class="fas fa-chart-pie"></i> Dashboard</h1>
            <div class="admin-actions">
                <button id="addContentBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Tambah Konten
                </button>
            </div>
        </div>

        <!-- Stats -->
        <div id="statsContainer" class="stats-grid"></div>

        <!-- Filter -->
        <div class="filter-bar">
            <div class="filter-search">
                <i class="fas fa-search"></i>
                <input type="text" id="filterSearch" placeholder="Cari judul atau deskripsi‚Ä¶">
            </div>
            <div class="filter-category">
                <select id="filterCategory" class="form-control">
                    <option value="Semua">Semua Kategori</option>
                    <option value="Film">üé¨ Film</option>
                    <option value="Teknologi">üíª Teknologi</option>
                    <option value="Keuangan">üí∞ Keuangan</option>
                    <option value="Kesehatan">üè• Kesehatan</option>
                </select>
            </div>
        </div>

        <!-- Table -->
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Thumbnail</th><th>Judul</th><th>Kategori</th>
                        <th>Tahun</th><th>Likes</th><th>Dibuat</th><th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="contentTable"></tbody>
            </table>
        </div>

    </main>
</div><!-- /adminSection -->

<!-- FORM MODAL -->
<div id="formModal" class="modal">
    <div class="modal-content modal-large">
        <div class="modal-header">
            <h3 id="modalTitle" class="modal-title">Tambah Konten Baru</h3>
            <button class="modal-close" id="formModalClose" aria-label="Tutup">&times;</button>
        </div>
        <form id="contentForm">
            <input type="hidden" id="contentId">
            <div class="modal-body">

                <!-- Info Utama -->
                <div class="form-section">
                    <h4 class="form-section-title"><i class="fas fa-info-circle"></i> Info Utama</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-tag"></i> Kategori *</label>
                            <select id="category" class="form-control" required>
                                <option value="">Pilih Kategori</option>
                                <option value="Film">üé¨ Film</option>
                                <option value="Teknologi">üíª Teknologi</option>
                                <option value="Keuangan">üí∞ Keuangan</option>
                                <option value="Kesehatan">üè• Kesehatan</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-heading"></i> Judul *</label>
                            <input type="text" id="title" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-calendar"></i> Tahun</label>
                            <input type="number" id="year" class="form-control" min="1900" max="2100">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-clock"></i> Durasi</label>
                            <input type="text" id="duration" class="form-control" placeholder="2j 30m">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-star"></i> Rating</label>
                            <input type="number" id="rating" class="form-control" step="0.1" min="0" max="10">
                        </div>

                        <!-- Rich Text Editor -->
                        <div class="form-group full-width">
                            <label class="form-label"><i class="fas fa-align-left"></i> Deskripsi</label>
                            <div class="rte-wrapper">
                                <div class="rte-toolbar" id="rteToolbar">
                                    <div class="rte-group">
                                        <button type="button" class="rte-btn" data-cmd="formatBlock" data-val="H2" title="Judul Besar">H2</button>
                                        <button type="button" class="rte-btn" data-cmd="formatBlock" data-val="H3" title="Judul Kecil">H3</button>
                                        <button type="button" class="rte-btn" data-cmd="formatBlock" data-val="P"  title="Paragraf Normal"><i class="fas fa-paragraph"></i></button>
                                    </div>
                                    <div class="rte-divider"></div>
                                    <div class="rte-group">
                                        <button type="button" class="rte-btn" data-cmd="bold"          title="Tebal (Ctrl+B)"><b>B</b></button>
                                        <button type="button" class="rte-btn" data-cmd="italic"        title="Miring (Ctrl+I)"><i>I</i></button>
                                        <button type="button" class="rte-btn" data-cmd="underline"     title="Garis Bawah (Ctrl+U)"><u>U</u></button>
                                        <button type="button" class="rte-btn" data-cmd="strikeThrough" title="Coret"><s>S</s></button>
                                    </div>
                                    <div class="rte-divider"></div>
                                    <div class="rte-group">
                                        <button type="button" class="rte-btn" data-cmd="justifyLeft"   title="Rata Kiri"><i class="fas fa-align-left"></i></button>
                                        <button type="button" class="rte-btn" data-cmd="justifyCenter" title="Rata Tengah"><i class="fas fa-align-center"></i></button>
                                        <button type="button" class="rte-btn" data-cmd="justifyRight"  title="Rata Kanan"><i class="fas fa-align-right"></i></button>
                                    </div>
                                    <div class="rte-divider"></div>
                                    <div class="rte-group">
                                        <button type="button" class="rte-btn" data-cmd="insertUnorderedList" title="Daftar Poin"><i class="fas fa-list-ul"></i></button>
                                        <button type="button" class="rte-btn" data-cmd="insertOrderedList"   title="Daftar Bernomor"><i class="fas fa-list-ol"></i></button>
                                        <button type="button" class="rte-btn" data-cmd="formatBlock" data-val="BLOCKQUOTE" title="Kutipan"><i class="fas fa-quote-right"></i></button>
                                    </div>
                                    <div class="rte-divider"></div>
                                    <div class="rte-group">
                                        <button type="button" class="rte-btn" id="rteLinkBtn"         title="Sisipkan Link"><i class="fas fa-link"></i></button>
                                        <button type="button" class="rte-btn" data-cmd="unlink"       title="Hapus Link"><i class="fas fa-unlink"></i></button>
                                        <button type="button" class="rte-btn" data-cmd="removeFormat" title="Hapus Format"><i class="fas fa-remove-format"></i></button>
                                    </div>
                                    <div class="rte-charcount" id="rteCharCount">0 karakter</div>
                                </div>
                                <div class="rte-editor" id="rteEditor" contenteditable="true"
                                     data-placeholder="Tulis deskripsi konten di sini..."></div>
                                <input type="hidden" id="description" name="description">
                            </div>
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label"><i class="fas fa-tags"></i> Tags</label>
                            <div class="tags-input-container">
                                <input type="text" id="tags" class="tags-input" placeholder="Ketik lalu tekan Enter‚Ä¶">
                            </div>
                            <small class="form-text">Pisahkan tag dengan koma atau tekan Enter</small>
                        </div>
                    </div>
                </div>

                <!-- Media -->
                <div class="form-section">
                    <h4 class="form-section-title"><i class="fas fa-play-circle"></i> Media</h4>
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label class="form-label"><i class="fas fa-image"></i> URL Thumbnail</label>
                            <input type="url" id="thumbnail_url" class="form-control" placeholder="https://...">
                            <div id="thumbnailPreview" class="thumbnail-preview hidden">
                                <img id="previewImage" src="" alt="Preview">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fab fa-youtube"></i> YouTube ID</label>
                            <input type="text" id="youtube_id" class="form-control" placeholder="zSWdZVtXT7E">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-video"></i> URL Video</label>
                            <input type="url" id="video_url" class="form-control" placeholder="https://...">
                        </div>
                    </div>
                </div>

                <!-- Affiliasi -->
                <div class="form-section">
                    <h4 class="form-section-title"><i class="fas fa-link"></i> Link Affiliasi</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-link"></i> URL Affiliasi</label>
                            <input type="url" id="affiliate_url" class="form-control" placeholder="https://...">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-tag"></i> Label Tombol</label>
                            <input type="text" id="affiliate_label" class="form-control" placeholder="Beli Sekarang">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-info-circle"></i> Deskripsi</label>
                            <input type="text" id="affiliate_desc" class="form-control" placeholder="Deskripsi singkat">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-certificate"></i> Badge</label>
                            <input type="text" id="affiliate_badge" class="form-control" placeholder="HOT / BARU / LIMITED">
                        </div>
                    </div>
                </div>

            </div><!-- /modal-body -->

            <div class="modal-footer">
                <button type="button" class="btn btn-outline" id="formCancelBtn">Batal</button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Simpan Konten
                </button>
            </div>
        </form>
    </div>
</div>

<!-- DELETE MODAL -->
<div id="deleteModal" class="modal">
    <div class="modal-content modal-sm">
        <div class="modal-header">
            <h3 class="modal-title">
                <i class="fas fa-exclamation-triangle" style="color:var(--error)"></i>
                Konfirmasi Hapus
            </h3>
            <button class="modal-close" id="deleteModalClose" aria-label="Tutup">&times;</button>
        </div>
        <div class="modal-body">
            <p>Apakah Anda yakin ingin menghapus konten ini?</p>
            <p class="delete-warning">
                <i class="fas fa-exclamation-triangle"></i>
                Tindakan ini tidak dapat dibatalkan.
            </p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline" id="deleteCancelBtn">Batal</button>
            <button type="button" id="confirmDelete" class="btn btn-danger">
                <i class="fas fa-trash"></i> Hapus
            </button>
        </div>
    </div>
</div>

<div id="toastContainer" class="toast-container"></div>

<!-- Scripts ‚Äî semua event listener ada di admin.js, tidak ada duplikasi inline -->
<script src="js/config.js"></script>
<script src="js/utils.js"></script>
<script src="js/db.js"></script>
<script src="js/admin.js"></script>

</body>
</html>
