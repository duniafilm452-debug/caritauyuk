<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Admin Panel ‚Äî Cari tau yuk</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay">
    <div class="spinner"></div>
</div>

<!-- ‚îÄ‚îÄ Login ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div id="loginSection" class="login-container">
    <div class="login-card">
        <div class="login-header">
            <div class="login-logo"><i class="fas fa-compass"></i></div>
            <h2 class="login-title">Admin Login</h2>
            <p class="login-subtitle">Masuk ke panel admin Cari tau yuk</p>
        </div>
        <form id="loginForm">
            <div class="form-group" style="margin-bottom:1rem">
                <label class="form-label"><i class="fas fa-envelope"></i> Email</label>
                <input type="email" id="email" class="form-control"
                       placeholder="admin@example.com" required autocomplete="email">
            </div>
            <div class="form-group" style="margin-bottom:1.5rem">
                <label class="form-label"><i class="fas fa-lock"></i> Password</label>
                <input type="password" id="password" class="form-control"
                       placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password">
            </div>
            <button type="submit" class="btn btn-primary btn-block">
                <i class="fas fa-sign-in-alt"></i> Masuk
            </button>
        </form>
        <div class="login-back">
            <a href="index.html"><i class="fas fa-arrow-left"></i> Kembali ke Beranda</a>
        </div>
    </div>
</div>

<!-- ‚îÄ‚îÄ Admin Panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div id="adminSection" class="admin-container hidden">

    <!-- Sidebar Overlay (mobile) -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Sidebar -->
    <aside class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-header">
            <a href="index.html" class="sidebar-logo">
                <i class="fas fa-compass"></i>
                <span>Cari tau yuk</span>
            </a>
            <div class="sidebar-user">
                <div class="user-avatar" id="userAvatar">A</div>
                <div class="user-info">
                    <div class="user-name"  id="userName">Admin</div>
                    <div class="user-email" id="userEmail">admin@example.com</div>
                </div>
            </div>
        </div>

        <ul class="admin-nav">
            <li class="admin-nav-item">
                <a href="#" class="admin-nav-link active">
                    <i class="fas fa-chart-pie"></i><span>Dashboard</span>
                </a>
            </li>
            <li class="admin-nav-item">
                <a href="#" class="admin-nav-link">
                    <i class="fas fa-newspaper"></i><span>Kelola Konten</span>
                </a>
            </li>
            <li class="admin-nav-item">
                <a href="#" class="admin-nav-link">
                    <i class="fas fa-tags"></i><span>Kategori</span>
                </a>
            </li>
            <li class="admin-nav-item">
                <a href="#" class="admin-nav-link">
                    <i class="fas fa-users"></i><span>Pengguna</span>
                </a>
            </li>
            <li class="admin-nav-item">
                <a href="#" class="admin-nav-link">
                    <i class="fas fa-chart-bar"></i><span>Statistik</span>
                </a>
            </li>
            <li class="admin-nav-item">
                <a href="#" class="admin-nav-link">
                    <i class="fas fa-cog"></i><span>Pengaturan</span>
                </a>
            </li>
        </ul>

        <div class="sidebar-footer">
            <a href="#" id="logoutBtn" class="admin-nav-link logout-link">
                <i class="fas fa-sign-out-alt"></i><span>Keluar</span>
            </a>
        </div>
    </aside>

    <!-- Main -->
    <main class="admin-main">

        <!-- Mobile Topbar -->
        <div class="mobile-topbar">
            <button class="hamburger-btn" id="hamburgerBtn" aria-label="Toggle menu">
                <span></span><span></span><span></span>
            </button>
            <span class="mobile-title">Dashboard</span>
            <button id="addContentBtnMobile" class="btn btn-primary btn-sm">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <!-- Desktop Header -->
        <div class="admin-header">
            <h1 class="admin-title">
                <i class="fas fa-chart-pie"></i> Dashboard
            </h1>
            <div class="admin-actions">
                <button id="addContentBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Tambah Konten
                </button>
            </div>
        </div>

        <!-- Stats -->
        <div id="statsContainer" class="stats-grid"></div>

        <!-- Filter Bar -->
        <div class="filter-bar">
            <div class="filter-search">
                <i class="fas fa-search"></i>
                <input type="text" id="filterSearch" placeholder="Cari judul atau deskripsi‚Ä¶">
            </div>
            <div class="filter-category">
                <select id="filterCategory" class="form-control">
                    <option value="Semua">Semua Kategori</option>
                    <option value="Film">üé¨ Film</option>
                    <option value="Teknologi">üíª Teknologi</option>
                    <option value="Keuangan">üí∞ Keuangan</option>
                    <option value="Kesehatan">üè• Kesehatan</option>
                </select>
            </div>
        </div>

        <!-- Table -->
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Thumbnail</th>
                        <th>Judul</th>
                        <th>Kategori</th>
                        <th>Tahun</th>
                        <th>Likes</th>
                        <th>Dibuat</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="contentTable"></tbody>
            </table>
        </div>
    </main>
</div>

<!-- ‚îÄ‚îÄ Form Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div id="formModal" class="modal">
    <div class="modal-content modal-large">
        <div class="modal-header">
            <h3 id="modalTitle" class="modal-title">Tambah Konten Baru</h3>
            <button class="modal-close" aria-label="Tutup">&times;</button>
        </div>
        <form id="contentForm">
            <input type="hidden" id="contentId">
            <div class="modal-body">
                <!-- Info Utama -->
                <div class="form-section">
                    <h4 class="form-section-title"><i class="fas fa-info-circle"></i> Info Utama</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-tag"></i> Kategori *</label>
                            <select id="category" class="form-control" required>
                                <option value="">Pilih Kategori</option>
                                <option value="Film">üé¨ Film</option>
                                <option value="Teknologi">üíª Teknologi</option>
                                <option value="Keuangan">üí∞ Keuangan</option>
                                <option value="Kesehatan">üè• Kesehatan</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-heading"></i> Judul *</label>
                            <input type="text" id="title" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-calendar"></i> Tahun</label>
                            <input type="number" id="year" class="form-control" min="1900" max="2100">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-clock"></i> Durasi</label>
                            <input type="text" id="duration" class="form-control" placeholder="2j 30m">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-star"></i> Rating</label>
                            <input type="number" id="rating" class="form-control" step="0.1" min="0" max="10">
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label"><i class="fas fa-align-left"></i> Deskripsi</label>
                            <textarea id="description" class="form-control" rows="4"></textarea>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label"><i class="fas fa-tags"></i> Tags</label>
                            <div class="tags-input-container">
                                <input type="text" id="tags" class="tags-input" placeholder="Ketik lalu Enter‚Ä¶">
                            </div>
                            <small class="form-text">Pisahkan tag dengan koma atau tekan Enter</small>
                        </div>
                    </div>
                </div>

                <!-- Media -->
                <div class="form-section">
                    <h4 class="form-section-title"><i class="fas fa-play-circle"></i> Media</h4>
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label class="form-label"><i class="fas fa-image"></i> URL Thumbnail</label>
                            <input type="url" id="thumbnail_url" class="form-control" placeholder="https://‚Ä¶">
                            <div id="thumbnailPreview" class="thumbnail-preview hidden">
                                <img id="previewImage" src="" alt="Preview">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fab fa-youtube"></i> YouTube ID</label>
                            <input type="text" id="youtube_id" class="form-control" placeholder="zSWdZVtXT7E">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-video"></i> URL Video</label>
                            <input type="url" id="video_url" class="form-control" placeholder="https://‚Ä¶">
                        </div>
                    </div>
                </div>

                <!-- Affiliasi -->
                <div class="form-section">
                    <h4 class="form-section-title"><i class="fas fa-link"></i> Link Affiliasi</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-link"></i> URL Affiliasi</label>
                            <input type="url" id="affiliate_url" class="form-control" placeholder="https://‚Ä¶">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-tag"></i> Label Tombol</label>
                            <input type="text" id="affiliate_label" class="form-control" placeholder="Beli Sekarang">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-info-circle"></i> Deskripsi</label>
                            <input type="text" id="affiliate_desc" class="form-control" placeholder="Deskripsi singkat">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-certificate"></i> Badge</label>
                            <input type="text" id="affiliate_badge" class="form-control" placeholder="HOT / BARU / LIMITED">
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-outline" onclick="closeAllModals()">Batal</button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Simpan Konten
                </button>
            </div>
        </form>
    </div>
</div>

<!-- ‚îÄ‚îÄ Delete Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div id="deleteModal" class="modal">
    <div class="modal-content modal-sm">
        <div class="modal-header">
            <h3 class="modal-title">
                <i class="fas fa-exclamation-triangle" style="color:var(--error)"></i>
                Konfirmasi Hapus
            </h3>
            <button class="modal-close" aria-label="Tutup">&times;</button>
        </div>
        <div class="modal-body">
            <p>Apakah Anda yakin ingin menghapus konten ini?</p>
            <p class="delete-warning">
                <i class="fas fa-exclamation-triangle"></i>
                Tindakan ini tidak dapat dibatalkan.
            </p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline" onclick="closeAllModals()">Batal</button>
            <button type="button" id="confirmDelete" class="btn btn-danger">
                <i class="fas fa-trash"></i> Hapus
            </button>
        </div>
    </div>
</div>

<!-- Toast -->
<div id="toastContainer" class="toast-container"></div>

<!-- FIX: app.js DIHAPUS ‚Äî admin hanya butuh utils.js untuk showToast dll -->
<script src="js/config.js"></script>
<script src="js/utils.js"></script>
<script src="js/db.js"></script>
<script src="js/admin.js"></script>

<!-- Mobile Sidebar Toggle -->
<script>
    const hamburgerBtn       = document.getElementById('hamburgerBtn');
    const adminSidebar       = document.getElementById('adminSidebar');
    const sidebarOverlay     = document.getElementById('sidebarOverlay');
    const addContentBtnMobile= document.getElementById('addContentBtnMobile');

    function toggleSidebar() {
        adminSidebar.classList.toggle('show');
        sidebarOverlay.classList.toggle('show');
        document.body.classList.toggle('sidebar-open');
    }

    if (hamburgerBtn)    hamburgerBtn.addEventListener('click', toggleSidebar);
    if (sidebarOverlay)  sidebarOverlay.addEventListener('click', toggleSidebar);
    if (addContentBtnMobile) {
        addContentBtnMobile.addEventListener('click', () => {
            if (typeof openFormModal === 'function') openFormModal();
        });
    }

    // Tutup sidebar saat nav link diklik (mobile)
    document.querySelectorAll('.admin-nav-link').forEach(link => {
        link.addEventListener('click', () => {
            if (window.innerWidth < 1024) {
                adminSidebar.classList.remove('show');
                sidebarOverlay.classList.remove('show');
                document.body.classList.remove('sidebar-open');
            }
        });
    });
</script>
</body>
</html>
